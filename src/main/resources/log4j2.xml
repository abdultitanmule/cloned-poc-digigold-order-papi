<?xml version="1.0" encoding="utf-8"?>
<Configuration packages="com.titan.logging.log4j2">


   

    <Appenders>
        <RollingFile name="file" fileName="${sys:mule.home}${sys:file.separator}logs${sys:file.separator}mulesoft-template-api.log" 
                 filePattern="${sys:mule.home}${sys:file.separator}logs${sys:file.separator}mulesoft-template-api-%i.log">
            <PatternLayout pattern="%-5p %d [%t] [processor: %X{processorPath}; event: %X{correlationId}] %c: %m%n" />
            <SizeBasedTriggeringPolicy size="10 MB" />
            <DefaultRolloverStrategy max="10"/>
        </RollingFile>
        <Log4j2Appender name="S3Appender">
			<PatternLayout pattern="%d{HH:mm:ss,SSS} [%t] %-5p %c{36} - %m%n"/>
			<verbose>false</verbose>
			<stagingBufferAge>${sys:log.s3.frequency}</stagingBufferAge>
			<s3Bucket>${sys:log.s3.bucket}</s3Bucket>
			<s3Path>${sys:deployment.name}</s3Path>	
			<s3Region>${sys:log.s3.aws.region}</s3Region>
			<s3Compression>${sys:log.s3.compress}</s3Compression>
			<s3StorageClass>${sys:log.s3.storageClass}</s3StorageClass>
			<s3AwsKey>${sys:log.s3.aws.accessKey}</s3AwsKey>
			<s3AwsSecret>${sys:log.s3.aws.secureKey}</s3AwsSecret>
		</Log4j2Appender>        
    </Appenders>
    <Loggers>
        
        <!-- Http Logger shows wire traffic on DEBUG. -->
        <!--AsyncLogger name="org.mule.service.http.impl.service.HttpMessageLogger" level="DEBUG" /-->
        <AsyncLogger name="org.mule.service.http" level="WARN"/>
        <AsyncLogger name="org.mule.extension.http" level="WARN"/>
    
		<!-- Mule logger -->        
        <AsyncLogger name="org.mule.runtime.core.internal.processor.LoggerMessageProcessor" level="INFO"/>
 
        <AsyncRoot level="INFO">
            		<AppenderRef ref="file" />
            		<AppenderRef ref="S3Appender" />
        	</AsyncRoot>
    </Loggers>
</Configuration>
